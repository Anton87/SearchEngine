#   wiki.sh
#   
#   First:
#       usage: source scripts/wiki-utils.sh
#
#   Then:
#       ssplit -lang it -segmenter TextPro -wikiFile /path/to/file -outputWikiFile /path/to/output/file
#


DIR="$( cd "$( dirname "${BASH_SOURCE[0]}" )" && pwd )"

# load the classpath stored in the classpath.txt file.
# The classpath can be generated by using the (ClassPathPrint) class.

source $DIR/../classpath.txt
echo "DIR: $DIR"


#function removeWikipediaPages
#    cat $1 | awk -F "\t" '$1 !~ /^Wikipedia:/' {print $0}'

function removeWikipediaPages {
    echo "removeWikipediaPages... "
    
    while [ -n "$(echo $1 | grep '-')" ]; do
        case $1 in 
            -help) echo 'process option -help'
                echo "removeWikipediaPages -wikiFile /path/to/file -outputWikiFile /path/to/output/file"
                return;;
            -wikiFile) echo 'process option -wikiFile'
                echo "-wikiFile $2"
                wikiFile="$2"
                shift;;
            -outputWikiFile) echo 'process option -outputWikiFile'
                echo "-outputWikiFile $2"
                outputWikiFile="$2"
                shift;;
        esac
        shift
    done
    
    echo "wikiFile: \"$wikiFile\""
    echo "outputWikiFile: \"$outputWikiFile\""
    
    if [ -z "$wikiFile" ]; then
        echo "wikiFile not specified"
        return 1
    fi
        
    if [ ! -f "$wikiFile" ]; then
        echo "file does not exist: $wikiFile"
        return 1
    fi
    
    if [ -z "$outputWikiFile" ]; then
        echo "outputWikiFile not specified"
        return 1
    fi    
    
    awk -F "\t" '$1 !~ /^Wikipedia:/ {print $0}' "$wikiFile" > "$outputWikiFile"
    awk -F "\t" '$1  ~ /^Wikipedia:/ {print $0}' "$wikiFile" > "${wikiFile}.wikipedia-pages.txt"
    
    unset wikiFile
    unset outputWikiFile
}




function ssplit {
    echo "ssplitting... "
    
    while [ -n "$(echo $1 | grep '-')" ]; do
        case $1 in 
            -help) #echo 'process option -help'
                java -cp "$CLASSPATH" it.unitn.nlpir.itwiki.ssplitter.WikiParagraphsSegmenter --help
                return;;
            -lang) #echo 'process option -lang'
                #echo "-lang $2"
                lang="$2"
                shift;;
            -segmenter) #echo 'process option -segmenter'
                #echo "-segmenter $2"
                segmenter="$2"
                shift;;
            -wikiFile) #echo 'process option -wikiFile'
                #echo "-wikiFile $2"
                wikiFile="$2"
                shift;;
            -outputWikiFile) #echo 'process option -outputWikiFile'
                #echo "-outputWikiFile $2"
                outputWikiFile="$2"
                shift;;
        esac
        shift
    done
    echo "lang: $lang"
    echo "segmenter: $segmenter"
    echo "wikiFile: $wikiFile"
    echo "outputWikiFile: $outputWikiFile"
    java -cp "$CLASSPATH" it.unitn.nlpir.itwiki.ssplitter.WikiParagraphsSegmenter -lang $lang -segmenter $segmenter -wikiFile "$wikiFile" -outputWikiFile "$outputWikiFile"
    
    unset lang
    unset segmenter
    unset wikiFile
    unset outputWikiFile
}

